<!DOCTYPE html>
<html lang="en">

	<head>
		<title>Morse Code Transmitter</title>
		<meta name="description" content="A Morse Code transmitter.  Works offline for remote adventures.">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" href="icons/logo-small.svg" type="image/svg">
		<meta name="theme-color" content="white">

		<!-- TODO: If this were hosted on gihub pages, then the base would need to be adjusted to wherever the service worker is located. -->
		<base href="/">

		<link rel="manifest" href="app.webmanifest">

		<link rel="stylesheet" href="style/index.css">
	</head>

	<body>
		<!-- App Shell -->
		<div id="screen-flash"></div>
		<main>
			<h1>Morse Code App</h1>
			<section id="message">
				<label>
					<span class="for-screen-reader">Text to transmit:</span>
					<textarea>Hello World</textarea>
				</label>
			</section>
			<section id="encoded">
				<label>
					<div>Code:</div>
					<output>
						<code id="translated"></code>
					</output>
				</label>
			</section>
			<section id="settings">
				<div id="output-modes">
					<label class="card">
						<input type="checkbox" id="audio-on" checked>
						<svg width="22" height="18" viewBox="0 0 22 18" xmlns="http://www.w3.org/2000/svg">
							<path d="M10 2L5 6H1V12H5L10 16V2Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
							<path d="M18.07 1.93005C19.9447 3.80533 20.9979 6.34841 20.9979 9.00005C20.9979 11.6517 19.9447 14.1948 18.07 16.0701M14.54 5.46005C15.4774 6.39769 16.004 7.66923 16.004 8.99505C16.004 10.3209 15.4774 11.5924 14.54 12.5301" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
						</svg>
						<span>Audio</span>
					</label>
					<label class="card">
						<input type="checkbox" id="torch-on" disabled>
						<svg width="26" height="28" viewBox="0 0 26 28" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M14.3333 1L1 16.6H13L11.6667 27L25 11.4H13L14.3333 1Z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
						</svg>

						<span>Flash</span>
					</label>
					<label class="card">
						<input type="checkbox" id="screen-on" checked>
						<svg width="18" height="25" viewBox="0 0 18 25" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" d="M14.5 1H3.25C2.00736 1 1 2.00736 1 3.25V21.25C1 22.4926 2.00736 23.5 3.25 23.5H14.5C15.7426 23.5 16.75 22.4926 16.75 21.25V3.25C16.75 2.00736 15.7426 1 14.5 1Z M9.375 7.75L9.375 7.75L8.87 11.75H13.375L8.375 17.75L8.875 13.75H4.375Z" stroke="none" />
							<path d="M14.5 1H3.25C2.00736 1 1 2.00736 1 3.25V21.25C1 22.4926 2.00736 23.5 3.25 23.5H14.5C15.7426 23.5 16.75 22.4926 16.75 21.25V3.25C16.75 2.00736 15.7426 1 14.5 1Z" fill="none" stroke-width="2" />
							<!--<path stroke="none" fill="lime" d="M9.375 7.75L9.375 7.75L8.87 11.75H13.375L8.375 17.75L8.875 13.75H4.375Z" /> -->
							<path stroke="none" fill="var(--lightning-color)" d="M9.375 7.75L4.375 13.75H8.875L8.375 17.75L13.375 11.75H8.875L9.375 7.75Z" />
						</svg>

						<span>Screen Flash</span>
					</label>
				</div>
				<div class="transmit">
					<label>
						<input id="repeat-on" type="checkbox">
						<svg width="22px" height="22px" viewBox="0 0 22 22" stroke="currentcolor" fill="none" xmlns="http://www.w3.org/2000/svg">
							<g clip-path="url(#clip0)">
								<path d="M15.5833 0.916626L19.2499 4.58329L15.5833 8.24996" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M2.75 10.0834V8.25004C2.75 7.27758 3.13631 6.34495 3.82394 5.65732C4.51158 4.96968 5.44421 4.58337 6.41667 4.58337H19.25" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M6.41667 21.0833L2.75 17.4167L6.41667 13.75" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M19.25 11.9166V13.75C19.25 14.7224 18.8637 15.6551 18.1761 16.3427C17.4884 17.0303 16.5558 17.4166 15.5833 17.4166H2.75" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
							</g>
							<defs>
								<clipPath id="clip0">
									<rect width="22" height="22" fill="white" />
								</clipPath>
							</defs>
						</svg>

						<span class="for-screen-reader">Repeat</span>
					</label>
					<button disabled>Transmit</button>
				</div>
				<div class="section settings">
					<details>
						<summary>
							<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentcolor">
								<path d="M2.33325 12.25V8.16663" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M2.33325 5.83333V1.75" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M7 12.25V7" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M7 4.66667V1.75" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M11.6667 12.25V9.33337" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M11.6667 7V1.75" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M0.583252 8.16663H4.08325" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M5.25 4.66663H8.75" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M9.91675 9.33337H13.4168" stroke-linecap="round" stroke-linejoin="round" />
							</svg>
							Advanced Settings
						</summary>
						<div>
							<label>
								<span>Dot duration in milliseconds</span>
								<input id="dot-duration" type="number" min="10" max="2000" value="100">
							</label>
							<label>
								<span>Words per minute</span>
								<input id="wpm" type="number" min="1" disabled>
							</label>
						</div>
					</details>
				</div>
				<div class="section install">
					<button style="display: none;">
						<svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentcolor" xmlns="http://www.w3.org/2000/svg">
							<rect x="0.5" y="0.5" width="17" height="17" rx="3.5" />
							<path d="M9 5.35132V12.6486" />
							<path d="M12.6487 9L5.35138 9" />
						</svg>
						Add app to homescreen
					</button>
				</div>
			</section>
		</main>
		<script type="application/javascript">
			// Get all the settings from local / session storage and apply them to the input elements so that the user can change them.  Then when our module runs and pulls the value from the input, it will show whatever the user has changed while loading.
			const plain_text = sessionStorage.getItem('plain-text');
			if (plain_text !== null) {
				document.querySelector('textarea').innerText = plain_text;
			}


			for (const key of ['audio-on', 'torch-on', 'screen-on', 'repeat-on']) {
				const stored = localStorage.getItem(key);
				if (stored !== null) {
					document.getElementById(key).checked = stored === 'true';
				}
			}

			const dd = localStorage.getItem('dot-duration');
			if (dd !== null) {
				document.getElementById('dot-duration').value = new Number(dd);
			}
		</script>
		<script type="module" src="index.mjs"></script>
	</body>

</html>