<!DOCTYPE html>
<html lang="en">

<head>
	<title>Morse Code Transmitter</title>
	<meta name="description" content="A Morse Code transmitter.  Works offline for remote adventures.">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" href="icons/logo-small.svg" type="image/svg">
	<meta name="theme-color" content="white">

	<!-- TODO: If this were hosted on gihub pages, then the base would need to be adjusted to wherever the service worker is located. -->
	<base href="/">

	<link rel="manifest" href="manifest.json">

	<link rel="stylesheet" href="style.css">
</head>

<body>
	<!-- App Shell -->
	<div id="screen-flash"></div>
	<main>
		<h1>Morse Code App</h1>
		<div class="section">
			<label>
				<span class="for-screen-reader">Text to transmit:</span>
				<textarea>Hello World</textarea>
			</label>
			Code:
			<code id="translated"></code>
		</div>
		<div class="mode section">
			<label class="good-name">
				<input type="checkbox" id="audio-on" checked>
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
					<path
						d="M17 2H7c-1.1 0-2 .9-2 2v16c0 1.1.9 1.99 2 1.99L17 22c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM7 20V4h10v16H7zm5-11c1.1 0 2-.9 2-2s-.9-2-2-2c-1.11 0-2 .9-2 2s.89 2 2 2zm0 2c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" />
				</svg>
				<span>Audio</span>
			</label>
			<label class="good-name">
				<input type="checkbox" id="torch-on" disabled>
				<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" viewBox="0 0 24 24">
					<path
						d="M18,2H6v6l2,3v11h8V11l2-3V2z M16,4v1H8V4H16z M14,10.4V20h-4v-9.61l-2-3V7h8v0.39L14,10.4z" />
					<circle cx="12" cy="14" r="1.5" />
				</svg>
				<span>Flash</span>
			</label>
			<label class="good-name">
				<input type="checkbox" id="screen-on" checked>
				<svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" viewBox="0 0 24 24">
					<path
						d="M14.5,11l-3,6v-4h-2l3-6v4H14.5z M17,3H7v1h10V3 M17,20H7v1h10V20 M17,1c1.1,0,2,0.9,2,2v18c0,1.1-0.9,2-2,2H7 c-1.1,0-2-0.9-2-2V3c0-1.1,0.9-2,2-2H17L17,1z M7,18h10V6H7V18L7,18z" />
				</svg>
				<span>Screen Flash</span>
			</label>
		</div>
		<div class="section transmit">
			<label class="good-name">
				<input id="repeat-on" type="checkbox">
				<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
					<path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z" />
				</svg>
				<span class="for-screen-reader">Repeat</span>
			</label>
			<button disabled>Transmit</button>
		</div>
		<div class="section settings">
			<details>
				<summary>Advanced</summary>
				<div>
					<label>
						<span>Dot duration in milliseconds</span>
						<input id="dot-duration" type="number" min="10" max="2000" value="100">
					</label>
					<label>
						<span>Words per minute</span>
						<input id="wpm" type="number" min="1" disabled>
					</label>
				</div>
			</details>
		</div>
		<div class="section install">
			<button style="display: none;">Add app to homescreen</button>
		</div>
	</main>
	<script type="application/javascript">
		// Get all the settings from local / session storage and apply the to the input elements so that the user can change them.  Then when our module runs and pulls the value from the input, it will show whatever the user has changed while loading.
		const plain_text = sessionStorage.getItem('plain-text');
		if (plain_text !== null) {
			document.querySelector('textarea').innerText = plain_text;
		}


		for (const key of ['audio-on', 'torch-on', 'screen-on', 'repeat-on']) {
			const stored = localStorage.getItem(key);
			if (stored !== null) {
				document.getElementById(key).checked = stored === 'true';
			}
		}

		const dd = localStorage.getItem('dot-duration');
		if (dd !== null) {
			document.getElementById('dot-duration').value = new Number(dd);
		}
	</script>
	<script type="module" src="index.mjs"></script>
</body>

</html>